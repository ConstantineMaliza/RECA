<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="description" content="Vali is a responsive and free admin theme built with Bootstrap 4, SASS and PUG.js. It's fully customizable and modular.">
    <!-- Twitter meta-->
    
    <title>RECA RWANDA</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Main CSS-->
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <link href="../css/modern-business.css" rel="stylesheet">
    <link href="css/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">

    <!-- Font-icon css-->
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body class="app sidebar-mini rtl">
    <!-- Navbar-->
    <header class="app-header"><a class="app-header__logo" id="head" href="dashboard.html">RECA</a>
      <!-- Sidebar toggle button--><a class="app-sidebar__toggle" href="#" data-toggle="sidebar" aria-label="Hide Sidebar"></a>
      <!-- Navbar Right Menu-->
      <ul class="app-nav">
      
        <!-- User Menu-->
        <li class="dropdown"><a class="app-nav__item" href="#" data-toggle="dropdown" aria-label="Open Profile Menu"><i class="fa fa-user fa-lg"></i></a>
          <ul class="dropdown-menu settings-menu dropdown-menu-right">
            <li><a class="dropdown-item" href="page-user.html"><i class="fa fa-cog fa-lg"></i> Settings</a></li>
            <li><a class="dropdown-item" href="page-user.html"><i class="fa fa-user fa-lg"></i> Profile</a></li>
            <li><a class="dropdown-item" href="" id="logout"><i class="fa fa-sign-out fa-lg"></i> Logout</a></li>
          </ul>
        </li>
      </ul>
    </header>
    <!-- Sidebar menu-->
    <div class="app-sidebar__overlay" data-toggle="sidebar"></div>
    <aside class="app-sidebar bg-primary">
      <div class="app-sidebar__user"><img class="app-sidebar__user-avatar img-fluid" src="https://allianceforscience.cornell.edu/wp-content/uploads/2019/08/habimana-jean-claude-350x350-c-default.jpg"" alt="User Image" style="max-width:100%;max-height:60px; height:auto;">
        <div>
          <p class="app-sidebar__user-name" id="user_name">John Doe</p>
          <p class="app-sidebar__user-designation">Admin</p>
        </div>
      </div>
      <ul class="app-menu">
        <li><a class="app-menu__item " href="dashboard.html"><i class="app-menu__icon fa fa-dashboard"></i><span class="app-menu__label"> Dashboard</span></a></li>
        <li class=""><a class="app-menu__item active" href="newspost.html" ><i class="app-menu__icon fab fa-pagelines"></i><span class="app-menu__label"> Post page</span></i></a>
        <li class=""><a class="app-menu__item " href="Climate_action.html" ><i class="app-menu__icon fab fa-autoprefixer"></i><span class="app-menu__label"> Climate action</span></i></a>
        <li class=""><a class="app-menu__item" href="Agriculture.html" ><i class="app-menu__icon fas fa-female"></i><span class="app-menu__label"> Agriculture</span></i></a>
        <li class=""><a class="app-menu__item" href="Gender_equity.html" ><i class="app-menu__icon fab fa-y-combinator"></i><span class="app-menu__label">  Gender equity</span></i></a>
        <li class=""><a class="app-menu__item" href="Youth.html" ><i class="app-menu__icon fab fa-envira"></i><span class="app-menu__label">  Youth</span></i></a>
        <li class=""><a class="app-menu__item" href="Biodiversity.html" ><i class="app-menu__icon fab fa-envira"></i><span class="app-menu__label">  Biodiversity</span></i></a>
       
      </ul>
    </aside>
    <main class="app-content">
     <div class="row">
        <div class="col-md-12">
            
            <div class="tile">
                <div class="row">
                <div class="col-md-12">
                    <div class="tile">
                      <h3 class="tile-title">Post</h3>
                      <div class="tile-body">
                        <form id="SavePost">
                            <div class="row">
                        <div class="col-md-6">
                          <div class="form-group" >
                            <label class="control-label">Title</label>
                            <input class="form-control" type="text" placeholder="Title of your post" id="title">
                          </div>
                        </div>
                        <div class="col-md-6">
                                <label class="control-label">Title</label>
                                <div class="form-control" >

                                <label class="radio-inline" ><input type="radio"id="Climate_action" name="optradio">Climate Action</label><br>
                                <label class="radio-inline"><input type="radio" id="Agriculture" name="optradio">Agriculture</label><br>
                                <label class="radio-inline"><input type="radio" id="Gender_equity"name="optradio">Gender Eguity</label><br>
                                <label class="radio-inline"><input type="radio" id="Youth"name="optradio">Youth</label><br>
                                <label class="radio-inline"><input type="radio" id="Biodiversity"name="optradio">Biodiversity</label>
                                </div>
                            </div>
                        
                        </div> 
                            <div class="row">
                                <div class="col-md-6">
                             <div class="form-group">
                            <label class="control-label">Description</label>
                            <textarea class="form-control"  name="" id="description" cols="30" rows="10"></textarea>
                                  
                            </div>

                         </div>
                         <div class="col-md-6">
                                <div class="form-group">
                                  <label class="control-label"></label>   
                                  <img class="form-control" id="imageFolder" src="" width="200" height="200">                        
                                  <input class="form-control" type="file"id="inputFile" >
                                  </div>
                                  </div>
                          </div> 
                          <div class="row">
                              
                              <div class="col-md-6">
                                <input class="form-control" type="text" placeholder="writer name" id="writer">

                              </div>
                          </div>
                          <div class="tile-footer">
                            <button class="btn btn-primary " type="" ><i class="fa fa-fw fa-lg fa-check-circle"></i>Publish</button></a>
                          </div>                         
                         
                        </form>
                      </div>
                     
                    </div>
                </div>
               
                </div>
            
            </div>
          </div>
     </div>
     
   
      
   
    </main>
    <!-- Essential javascripts for application to work-->
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/main.js"></script>
    <!-- The javascript plugin to display page loading on top-->
    <script src="js/plugins/pace.min.js"></script>
    <!-- Page specific javascripts-->
    <script type="text/javascript" src="js/plugins/chart.js"></script>
    
      <!-- The core Firebase JS SDK is always required and must be listed first -->
      <script src="https://www.gstatic.com/firebasejs/6.3.4/firebase-app.js"></script>
      <script src="https://www.gstatic.com/firebasejs/6.3.4/firebase-auth.js"></script>
      <script src="https://www.gstatic.com/firebasejs/6.3.4/firebase-database.js"></script>
      <script src="https://www.gstatic.com/firebasejs/6.3.4/firebase-storage.js"></script>
  
      <!-- TODO: Add SDKs for Firebase products that you want to use
          https://firebase.google.com/docs/web/setup#config-web-app -->
  
      <script>
      // Your web app's Firebase configuration
      var firebaseConfig = {
          apiKey: "AIzaSyA9z8-VtN-TeU3Fptd9eHEA3o1URaTezxo",
          authDomain: "reca-rwanda-1f35d.firebaseapp.com",
          databaseURL: "https://reca-rwanda-1f35d.firebaseio.com",
          projectId: "reca-rwanda-1f35d",
          storageBucket: "reca-rwanda-1f35d.appspot.com",
          messagingSenderId: "153010824532",
          appId: "1:153010824532:web:062629fdcbac5b74"
      };
      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      const auth=firebase.auth();
      const database=firebase.database();
      const storage = firebase.storage();
     

      var uid=database.ref('Climate_action').push().key;
      var photo="";
      var photo1 = "";

      document.getElementById("inputFile").addEventListener('change', function(input) {

            file = input.target.files[0];

            var path = window.URL.createObjectURL(file);

            document.querySelector("#imageFolder").src = path;
            storage.ref("Photo").child(uid +".png").put(file)
            .then(snapshot => snapshot.ref.getDownloadURL())
            .then((link) => {                                
               alert(link);
              photo=link;
              alert("successfull");
            });	

            });
     

      
        const age=document.querySelector("#SavePost");
        age.addEventListener('submit', (e) =>{

            e.preventDefault();

            const title = age['title'].value;
            const description = age['description'].value;
            const writer = age['writer'].value;
            
          
      var Climate_action=document.getElementById("Climate_action");
      var Gender_equity=document.getElementById("Gender_equity");
      var Biodiversity=document.getElementById("Biodiversity");
      var Agriculture=document.getElementById("Agriculture");
      var Youth=document.getElementById("Youth");
      var ischecked = "";
      if( Climate_action.checked==true){
        ischecked="Climate_action";
      }else if(Gender_equity.checked==true){
        ischecked="Gender_equity"; 
      }else if(Biodiversity.checked==true){
        ischecked="Biodiversity"; 
      }else if(Agriculture.checked==true){
        ischecked="Agriculture"; 
      }else if(Youth.checked==true){
        ischecked="Youth"; 
      }
          
          
            WriteDataProfile(uid, title, description);

          

            function WriteDataProfile(uid, title, description ){  //input data in database
                alert(photo);
                    database.ref(ischecked).child(uid).set({
                    Title:title,
                    Description :description,
                    type:ischecked,
                    photo:photo,
                    writer_name:writer,
                    date:new Date().getTime()
                    
                    }).then(function(){
                      window.location.href="newspost.html";
                      const title = "";
                     const description = "";
                    const writer = "";
                    var photo="";

                    });
                    
                }
            
        });
        const logout=document.querySelector("#logout");
              logout.addEventListener('click',(e)=>{
                e.preventDefault();
                auth.signOut().then(()=>{
                
                  window.location.href="index.html";
                });
            });
            document.getElementById("user_name").innerHTML=sessionStorage.getItem("userName");


                    
    </script>
    <script src="js/auth.js"></script>
  </body>
</html>